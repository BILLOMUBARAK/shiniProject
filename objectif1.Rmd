---
title: "objectif1"
author: "obj1"
date: "2023-11-13"
output: github_document
---
### chargement des librairies
```{r}
library(ggplot2)
library(dplyr)
```

### chargement des données
```{r}
amsterdam <- read.csv("data/amsterdam_weekends.csv")
athens <- read.csv("data/athens_weekends.csv")
barcelona <- read.csv("data/barcelona_weekends.csv")
berlin <- read.csv("data/berlin_weekends.csv")
budapest <- read.csv("data/budapest_weekends.csv")
lisbon <- read.csv("data/lisbon_weekends.csv")
london <- read.csv("data/london_weekends.csv")
paris <- read.csv("data/paris_weekends.csv")
rome <- read.csv("data/rome_weekends.csv")
vienna <- read.csv("data/vienna_weekends.csv")

cityList = list(amsterdam, athens, barcelona, berlin, budapest, lisbon, london, paris, rome, vienna)
colorVector = c("orange", "blue", "red", "yellow", "chartreuse1", "seagreen", "brown", "thistle","cadetblue1", "gold1")
```

###Graphe Ligne Combiné
```{r}
citiesPriceToDistComparison <- function(dataset_list, colorVector) {
  
  combined_data <- bind_rows(dataset_list, .id = "city")
  
  combined_plot <- ggplot(combined_data, aes(x = dist, y = realSum, color = city)) +
    geom_line() +
    labs(
      title = "Prix des Airbnb en fonction de la distance au centre-ville",
      x = "Distance au centre-ville",
      y = "Prix total de l'annonce"
    ) +
    scale_color_manual(values = colorVector) +
    theme_minimal()
  
  return(combined_plot)
}

citiesPriceToDistComparison(cityList, colorVector)
```

###creation de fonction pour automatiser le processus

```{r}
graphe<-function(data){
  
  line_chart<- ggplot(data,aes(x=dist, y=realSum))+
    geom_line(color="blue")+
    labs(title="Prix des Airbnb en fonction de la distance au
         centre-ville",
         x="Distance au centre-ville",
         y="Prix total de l'annonce") +
    theme_minimal()
  
  line_chart
  
}
```


```{r}
graphe(amsterdam)
graphe(athens)
```

###FONCTION 2 HS
```{r}
generate_airbnb_plots <- function(data) {
  # Charger la bibliothèque ggplot2
  library(ggplot2)

  # Créer un graphique en lignes avec ggplot
  line_chart <- ggplot(data, aes(x = dist, y = realSum, group = 1)) +
    geom_line(color = "blue") +
    labs(title = "Prix des Airbnb en fonction de la distance au centre-ville",
         x = "Distance au centre-ville",
         y = "Prix total de l'annonce") +
    theme_minimal()

  # Créer des graphiques de boxplots avec courbe de tendance pour chaque ville
  boxplots <- ggplot(data, aes(x = as.factor(dist), y = realSum, fill = as.factor(dist))) +
    geom_boxplot() +
    geom_point(position = position_jitter(width = 0.2), alpha = 0.7) +
    labs(title = "Boxplots avec Courbe de Tendance pour chaque ville",
         x = "Distance au centre-ville",
         y = "Prix total de l'annonce") +
    theme_minimal()

  # Afficher les graphiques
  line_chart
  boxplots
}


```


